'use strict';
Object.defineProperty(exports, '__esModule', {
  value: true
});

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _inquirer = require('inquirer');

var _inquirer2 = _interopRequireDefault(_inquirer);

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _getDirectories = require('./getDirectories');

var _getDirectories2 = _interopRequireDefault(_getDirectories);

exports['default'] = function (_message, basePath, callback) {
  if (_message === undefined) _message = 'Please choose a folder';
  if (basePath === undefined) basePath = './';

  var depth = 0;

  prompt(basePath);

  function prompt(srcPath) {
    var choices = (0, _getDirectories2['default'])(srcPath);

    if (choices.length > 0) {
      choices.push(new _inquirer2['default'].Separator());
    }

    choices.push('choose this folder');

    if (depth > 0) {
      choices.push(new _inquirer2['default'].Separator());
      choices.push('.. back');
    }

    process.stdout.write('\u001b[2J\u001b[0;0f');

    _inquirer2['default'].prompt([{
      type: 'list',
      name: 'path',
      message: function message() {
        return _message + (' (current folder: ' + srcPath + ')');
      },
      choices: choices
    }], function (answers) {
      if (answers.path === 'choose this folder') {
        callback(srcPath);
      } else if (answers.path === '.. back') {
        depth--;
        prompt(_path2['default'].dirname(srcPath));
      } else {
        depth++;
        prompt(_path2['default'].join(srcPath, answers.path));
      }
    });
  }
};

;
module.exports = exports['default'];